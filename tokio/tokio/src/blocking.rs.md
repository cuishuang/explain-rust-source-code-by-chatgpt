# File: tokio/tokio/src/blocking.rs

在tokio源代码中，tokio/src/blocking.rs文件包含了用于在非异步上下文中执行阻塞操作的功能。这个文件定义了一个run函数和JoinHandle<R>结构体。

1. run函数：run函数是一个宏，它用于将一个闭包传递给tokio的阻塞线程池来执行。run宏会在异步运行时的运行时上下文之外创建一个新的线程，并在该线程上执行被传递的闭包。这允许在异步上下文中执行的代码（例如异步任务）调用阻塞操作（例如文件IO或计算密集型任务）。

2. JoinHandle<R>：JoinHandle<R>是一个结构体，表示一个异步阻塞操作的句柄。它包含了异步阻塞操作的结果，并提供了一些方法来处理异步操作的结果。JoinHandle<R>是一个Future，可以使用await关键字等待异步操作的完成，并获取结果。

JoinHandle<R>结构体具有以下主要方法：

- `await`方法：该方法用于等待异步操作的完成，并返回结果。它会挂起当前任务，直到异步操作完成并返回结果。
- `join`方法：该方法用于等待异步操作的完成，但不返回结果。它会挂起当前任务，直到异步操作完成。
- `join_blocking`方法：该方法用于等待异步操作的完成，并在阻塞线程池中执行给定的闭包。它会挂起当前任务，直到异步操作完成，然后在阻塞线程中执行闭包。
- `try_join`方法：该方法用于等待多个JoinHandle<R>的完成，并返回一个包含所有结果的元组。它会挂起当前任务，直到所有异步操作完成。
- `into_inner`方法：该方法用于从JoinHandle<R>中提取出结果。如果JoinHandle<R>已经完成，则返回结果，否则阻塞当前任务直到完成。
- `poll`方法：该方法用于轮询JoinHandle<R>，检查异步操作的状态并获取结果。

这些功能使得在异步上下文中执行阻塞操作变得更加方便和有效率。

