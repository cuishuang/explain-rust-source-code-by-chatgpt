# File: tokio/tokio/src/runtime/scheduler/multi_thread/worker/metrics.rs

tokio/tokio/src/runtime/scheduler/multi_thread/worker/metrics.rs是Tokio库中实现多线程调度器的工作线程度量指标(`metrics`)模块的源代码文件。

在Tokio中，多线程调度器是一种用于在多个工作线程上分配异步任务执行的调度策略。该调度器使用一个或多个工作线程执行一些已经就绪的异步任务（例如，Future）。

`metrics.rs`模块的主要目的是收集和跟踪与工作线程相关的度量指标，以便可以监视和优化调度器的性能。度量指标通常涉及一些关键的指标，如工作线程的活跃数、工作线程的空闲时间、工作线程的执行次数等。

具体来说，`metrics`模块的实现包含以下几个重要的结构和功能：

1. **WorkerMetrics**：这是一个度量指标结构，用于跟踪单个工作线程的度量指标。它包含了活跃计数器、空闲计数器、耗时计数器等。
2. **MetricsSet**：这是一个度量指标集合，用于跟踪所有工作线程的度量指标。它持有多个`WorkerMetrics`实例，并提供对它们的聚合和查询功能。
3. **MetricsSummary**：这是一个度量指标摘要结构，用于收集和展示对工作线程度量指标的总结信息。它包含了有关工作线程汇总、耗时百分比、空闲百分比等的信息。
4. **MetricsLevel**：这是一个度量指标级别枚举，用于控制度量指标的详细程度。它分为无、基本和详细三个级别，决定了度量指标的采样频率和精度。
5. **MetricsSampler**：这是一个度量指标采样器结构，用于在工作线程上对度量指标进行采样。它根据设置的度量级别和采样间隔，定期调用工作线程的度量方法。

总的来说，`metrics.rs`文件实现了Tokio多线程调度器中用于收集、跟踪和展示工作线程度量指标信息的功能。这些度量指标能够帮助开发者了解调度器的运行状况和性能，从而进行优化和调整。

